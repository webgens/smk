/*
Copyright (c) 2017 NAVER Corp.
@egjs/infinitegrid project is licensed under the MIT license

@egjs/infinitegrid JavaScript library
https://github.com/naver/egjs-infinitegrid

@version 3.5.0
All-in-one packaged file for ease use of '@egjs/infinitegrid' with below dependencies.
- @egjs/component ^2.1.2
NOTE: This is not an official distribution file and is only for user convenience.

*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.eg=t.eg||{},t.eg.InfiniteGrid=e())}(this,function(){"use strict";function v(){return(v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function i(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function a(t){return void 0===t}var h,e=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var i=this._eventHandler[t]||[];if(!(0<i.length))return!0;i=i.concat(),e.eventType=t;var n=!1,r=[e],s=0;e.stop=function(){n=!0},e.currentTarget=this;for(var o=arguments.length,a=new Array(2<o?o-2:0),h=2;h<o;h++)a[h-2]=arguments[h];for(1<=a.length&&(r=r.concat(a)),s=0;i[s];s++)i[s].apply(this,r);return!n},e.once=function(r,s){if("object"==typeof r&&a(s)){var t,e=r;for(t in e)this.once(t,e[t]);return this}if("string"==typeof r&&"function"==typeof s){var o=this;this.on(r,function t(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];s.apply(o,i),o.off(r,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&a(e)){var i,n=t;for(i in n)this.on(i,n[i]);return this}if("string"==typeof t&&"function"==typeof e){var r=this._eventHandler[t];a(r)&&(this._eventHandler[t]=[],r=this._eventHandler[t]),r.push(e)}return this},e.off=function(t,e){if(a(t))return this._eventHandler={},this;if(a(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var i,n=t;for(i in n)this.off(i,n[i]);return this}var r,s,o=this._eventHandler[t];if(o)for(r=0;void 0!==(s=o[r]);r++)if(s===e){o=o.splice(r,1);break}return this},t}();return t.VERSION="2.1.2",t}(),u=(h="undefined"==typeof window?{document:{},navigator:{userAgent:""}}:window).document,t=h.navigator.userAgent,n=!!("getComputedStyle"in h),s=!!("addEventListener"in u),o=function(){var t=!1;try{s&&Object.defineProperty&&u.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){t=!0}}))}catch(t){}return t}(),g=/MSIE|Trident|Windows Phone|Edge/.test(t),_=/iPhone|iPad/.test(t),l=/Android 2\./.test(t),f="_eg-infinitegrid-ignore_",c="_INFINITEGRID_TRANSITION",m=!0,r=!1,p="vertical",d="horizontal",W=-1e5,y="data-groupkey",z={horizontal:!1,margin:0},S=t.toLowerCase(),w=(/mobi|ios|android/.test(S),"start"),C="center",I="end",E="justify",M=/applewebkit\/([\d|.]*)/g.exec(S),x=M&&parseInt(M[1],10)||0,L=x&&x<537,b=function(){var t={transitionend:"",webkitTransitionEnd:"-webkit-",oTransitionEnd:"-o-",mozTransitionEnd:"-moz-"};for(var e in t){var i=t[e];if("on"+e.toLowerCase()in h)return[i+"transform",i+"transition",e]}return[]}(),O=b[0],P=b[1],A=b[2];function T(t){var e=[];if(t)for(var i=0,n=t.length;i<n;i++)e.push(t[i]);return e}function R(t){return t.match(/^<([A-z]+)\s*([^>]*)>/)}function k(t,e){var i;if(void 0===e&&(e=!1),"string"==typeof t){if(R(t)){var n=u.createElement("div");n.innerHTML=t,i=n.childNodes}else i=u.querySelectorAll(t);i=e?T(i):i&&0<i.length&&i[0]||void 0}else t===h?i=t:!t.nodeName||1!==t.nodeType&&9!==t.nodeType?"function"==typeof h.jQuery&&t instanceof h.jQuery||t.constructor.prototype.jquery?i=k(e?t.toArray():t.get(0),e):Array.isArray(t)&&(i=t.map(function(t){return k(t)}),e||(i=1<=i.length?i[0]:void 0)):i=t;return i}function F(t,e,i,n){if(s){var r=n||!1;"object"==typeof n&&(r=!!o&&n),t.addEventListener(e,i,r)}else t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}function j(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=null}function H(t){return(n?h.getComputedStyle(t):t.currentStyle)||{}}function V(t,e,i){if(t===h)return h["inner"+e]||u.body["client"+e];if(9===t.nodeType){var n=t.documentElement;return Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])}var r=0;if(i){var s=t.getBoundingClientRect();r="Width"===e?s.right-s.left:s.bottom-s.top}else r=t["client"+e]||t["offset"+e];return parseFloat(r||H(t)[e.toLowerCase()])||0}function q(t){return V(t,"Width",!1)}function B(t){return V(t,"Height",!1)}function N(t){return V(t,"Width",!0)}function K(t){return V(t,"Height",!0)}function D(t){return{width:N(t),height:K(t)}}var X={vertical:{pos1:"top",endPos1:"bottom",size1:"height",pos2:"left",endPos2:"right",size2:"width"},horizontal:{pos1:"left",endPos1:"right",size1:"width",pos2:"top",endPos2:"bottom",size2:"height"}};function G(t){return X[t?d:p]}function U(t,e){return v({},z,t,e)}function Y(t){return t.map(function(t){return v({},t)})}function Q(t,e){for(var i=t.length-1;0<=i;--i)t[i]=e;return t}function J(t){return void 0===t}var $=function(){function r(){this.clear()}r.from=function(t,e,i){var n=i.groupKey;i.isAppend;return T(r.selectItems(k(t,!0),e)).map(function(t){return{el:t,groupKey:n,content:t.outerHTML,rect:{top:W,left:W}}})},r.selectItems=function(t,i){return t.filter(function(t){var e=t.className.split(" ");return!e.some(function(t){return t===f})&&(i&&"*"!==i?e.some(function(t){return t===i}):t)})},r.pluck=function(t,i){return t.reduce(function(t,e){return t.concat(e[i])},[])};var t=r.prototype;return t.getStatus=function(t,e){var i=this._data,n=Math.max(this.indexOf(t),0),r=this.indexOf(e)+1||i.length;return{_data:i.slice(n,r).map(function(t){var e=t.items.map(function(t){var e=v({},t);return delete e.el,e}),i=v({},t);return i.items=e,i})}},t.setStatus=function(t){var e=t._data;this.set(e)},t.size=function(){return this._data.length},t.fit=function(e,t){if(this._data.length){var i=t?"left":"top";0!==e&&(this._data=this._data.map(function(t){return t.items=t.items.map(function(t){return t.rect[i]-=e,t}),t.outlines.start=t.outlines.start.map(function(t){return t-e}),t.outlines.end=t.outlines.end.map(function(t){return t-e}),t}))}},t.pluck=function(t,e,i){var n=J(e)?this._data:this._data.slice(e,(J(i)?e:i)+1);return r.pluck(n,t)},t.getOutline=function(t,e){var i=this._data[t];return i?i.outlines[e]:[]},t.getEdgeIndex=function(t,e,i){for(var n="start"===t?"min":"max",r=-1,s="start"===t?1/0:-1/0,o=e;o<=i;o++){var a=Math[n].apply(Math,this.getOutline(o,t));("start"===t&&a<s||"end"===t&&s<a)&&(s=a,r=o)}return r},t.getEdgeValue=function(i,t,e){var n=this.pluck("outlines",this.getEdgeIndex(i,t,e)).reduce(function(t,e){return t.concat(e[i])},[]);return n.length?Math["start"===i?"min":"max"].apply(Math,n):0},t.clearOutlines=function(i,n){void 0===i&&(i=-1),void 0===n&&(n=-1),this.get().forEach(function(t,e){i<=e&&e<=n||(t.items.forEach(function(t){t.rect.top=W,t.rect.left=W}),t.outlines.start=[],t.outlines.end=[])})},t.getMaxEdgeValue=function(){for(var t=this.get(),e=t.length-1;0<=e;--e){var i=t[e].outlines.end;if(i.length)return Math.max.apply(Math,i)}return 0},t.append=function(t){return this._data.push(t),t.items},t.prepend=function(t){return this._data.unshift(t),t.items},t.clear=function(){this._data=[]},t.remove=function(t,e,i){var n=[],r=t.getAttribute(y),s=this.get(e,i).filter(function(t){return String(t.groupKey)===r});if(!s.length)return n;for(var o=(s=s[0]).items.length,a=-1,h=0;h<o;h++)if(s.items[h].el===t){a=h;break}return~a&&(s.items.splice(a,1),this.set(s,r),n=s.items),n},t.indexOf=function(t){for(var e="object"==typeof t?t.groupKey:t,i=this._data,n=i.length,r=0;r<n;++r)if(e===i[r].groupKey)return r;return-1},t.get=function(t,e){return J(t)?this._data:this._data.slice(t,(J(e)?t:e)+1)},t.set=function(t,e){if(J(e)||Array.isArray(t))this._data=t.concat();else{for(var i=this._data.length,n=-1,r=0;r<i;r++)if(this._data[r].groupKey===e){n=r;break}~n&&(this._data[n]=t)}},t.getData=function(t){return this._data[t]},r}();function Z(t,e,i){t.forEach(function(t){t in e&&(i[t]=e[t]+"px")})}function tt(t,e,i,n){t[P+"-property"]=e?O+",width,height":"",t[P+"-duration"]=e?e+"s":"",t[P+"-delay"]=e?"0s":"",t[O]=e?"translate("+(i.left-n.left)+"px,"+(i.top-n.top)+"px)":""}var et=function(){function s(t,e){v(this.options={isEqualSize:!1,isConstantSize:!1,horizontal:!1,container:!1},e),this._size={container:-1,view:-1,viewport:-1,item:null},this._init(t),this.resize()}s.renderItem=function(e,t,i){if(e.el){var n,r,s,o,a=e.el,h=e.prevRect,u=a.style;if(a.setAttribute(y,e.groupKey),u.position="absolute",Z(["width","height"],t,u),i&&P&&h){if(tt(u,i,t,h),a[c])return;a[c]=!0,s=function(){var t=e.rect;tt(u),Z(["left","top"],t,u),e.prevRect=t,a[c]=!1},F(n=a,r=A,function t(e){j(n,r,t),s(e)},o)}else Z(["left","top"],t,u),e.prevRect=t}},s.renderItems=function(t,e){t.forEach(function(t){s.renderItem(t,t.rect,e)})},s.removeItems=function(t){t.forEach(function(t){t.el&&(s.removeElement(t.el),t.el=null)})},s.removeElement=function(t){var e=t&&t.parentNode;e&&e.removeChild(t)},s.createElements=function(t){if(t.length){var e=t.filter(function(t){return!t.el});if(e.length){var i=k(e.map(function(t){return t.content.replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")}).join(""),!0);e.forEach(function(t,e){t.el=i[e]})}}};var t=s.prototype;return t.getStatus=function(){return{cssText:this.container.style.cssText,_size:v({},this._size)}},t.setStatus=function(t){this.container.style.cssText=t.cssText,v(this._size,t._size)},t.updateSize=function(t){var e=this.options,i=e.isEqualSize,n=e.isConstantSize,r=this._size;return t.map(function(t){return t.el&&(i&&!r.item&&(r.item=D(t.el)),t.size=i&&v(r.item)||n&&t.orgSize&&v(t.orgSize)||D(t.el),t.orgSize||(t.orgSize=v({},t.size))),t})},t._init=function(t){var e=k(t),i=H(e),n=this.options,r=n.container,s=n.horizontal;if(this._orgStyle={},"static"===i.position&&(this._orgStyle.position=e.style.position,e.style.position="relative"),r){var o=s?["X","Y"]:["Y","X"];this._orgStyle.overflowX=e.style.overflowX,this._orgStyle.overflowY=e.style.overflowY,e.style["overflow"+o[0]]="scroll",e.style["overflow"+o[1]]="hidden",this.view=e,this.container=!0===r?function(t){var e=u.createElement("div");e.className="_eg-infinitegrid-container_",e.style.position="relative",e.style.height="100%";for(var i=t.children,n=i.length,r=0;r<n;r++)e.appendChild(i[0]);return t.appendChild(e),e}(this.view):r}else this.view=h,this.container=e},t.append=function(t){this._insert(t,m,{top:W,left:W})},t.prepend=function(t){this._insert(t,r,{top:W,left:W})},t.createAndInsert=function(t,e){s.createElements(t),s.renderItems(t),this._insert(t,e)},t._insert=function(t,e,i){var n=this.container,r=u.createDocumentFragment();t.forEach(function(t){i&&s.renderItem(t,i),e?r.appendChild(t.el):r.insertBefore(t.el,r.firstChild)}),e?n.appendChild(r):n.insertBefore(r,n.firstChild)},t._calcSize=function(){return this.options.horizontal?B(this.container):q(this.container)},t.getViewSize=function(){return this._size.view},t.getViewportSize=function(){return this._size.viewport},t.setContainerSize=function(t){this.container.style[this.options.horizontal?"width":"height"]=t+"px"},t.resize=function(){var t=this.options.horizontal,e=this.view,i=this.isNeededResize();return i&&(this._size={viewport:this._calcSize(),item:null}),this._size.view=t?q(e):B(e),i},t.isNeededResize=function(){return this._calcSize()!==this._size.viewport},t.clear=function(){this.container.innerHTML="",this.container.style[this.options.horizontal?"width":"height"]="",this._size={item:null,viewport:-1,container:-1,view:-1}},t.destroy=function(){this.clear();var t=this.options.container;for(var e in this._orgStyle)this[t?"view":"container"].style[e]=this._orgStyle[e];t&&this.container.parentNode.removeChild(this.container)},s}(),it=function(){function t(t,e){v(this.options={container:t,resize:function(){},check:function(){},isOverflowScroll:!1,horizontal:!1},e),this._timer={resize:null},this.reset(),this._containerOffset=0,this._view=t,this._scrollIssue=_,this._onCheck=this._onCheck.bind(this),this._onResize=this._onResize.bind(this),this.attachEvent(),this.resize(),this.setScrollPos()}var e=t.prototype;return e.getStatus=function(){return{_prevPos:this._prevPos,scrollPos:this.getOrgScrollPos()}},e.setStatus=function(t,e){void 0===e&&(e=!0),this._prevPos=t._prevPos,e&&this.scrollTo(t.scrollPos)},e.scrollBy=function(t){var e=this.options.horizontal?[t,0]:[0,t];(function(t,e,i){t===h?t.scrollBy(e,i):(t.scrollLeft+=e,t.scrollTop+=i)}).apply(void 0,[this._view].concat(e)),this.setScrollPos()},e.scrollTo=function(t){var e=this.options.horizontal?[t,0]:[0,t];(function(t,e,i){t===h?t.scroll(e,i):(t.scrollLeft=e,t.scrollTop=i)}).apply(void 0,[this._view].concat(e))},e.getScrollPos=function(){return this._prevPos},e.setScrollPos=function(t){var e=t;void 0===t&&(e=this.getOrgScrollPos()),this._prevPos=e-this.getContainerOffset()},e.attachEvent=function(){F(this._view,"scroll",this._onCheck),F(h,"resize",this._onResize)},e.getOrgScrollPos=function(){return function(t,e){void 0===e&&(e=!1);var i="scroll"+(e?"Left":"Top");return t===h?h[e?"pageXOffset":"pageYOffset"]||u.body[i]||u.documentElement[i]:t[i]}(this._view,this.options.horizontal)},e.reset=function(){this._prevPos=null},e._onCheck=function(){var t=this.getScrollPos(),e=this.getOrgScrollPos();this.setScrollPos(e);var i=this.getScrollPos();null===t||this._scrollIssue&&0===e||t===i?e&&(this._scrollIssue=!1):(this._scrollIssue=!1,this.options.check({isForward:t<i,scrollPos:i,orgScrollPos:e,horizontal:this.options.horizontal}))},e.getContainerOffset=function(){return this._containerOffset},e._getOffset=function(){var t=this.options,e=t.container,i=t.horizontal;return e.getBoundingClientRect()[i?"left":"top"]+this.getOrgScrollPos()},e.resize=function(){this._containerOffset=this.options.isOverflowScroll?0:this._getOffset()},e._onResize=function(){var t=this;this._timer.resize&&clearTimeout(this._timer.resize),this._timer.resize=setTimeout(function(){t.resize(),t.options.resize(),t._timer.resize=null,t.reset()},100)},e.detachEvent=function(){j(this._view,"scroll",this._onCheck),j(h,"resize",this._onResize)},e.destroy=function(){this.detachEvent(),this.reset()},t}();var nt=function(){function t(t,e){this.options=v({useRecycle:!0,threshold:100,append:function(){},prepend:function(){},recycle:function(){}},e),this._items=t,this.clear()}var e=t.prototype;return e.setSize=function(t){this._status.size=t},e.recycle=function(e,t){if(this.options.useRecycle){var i=this._status,n=i.startCursor,r=i.endCursor,s=i.size;if(-1!==n&&-1!==r){var o=e+s,a=this.options,h=a.threshold,u=a.recycle,c=this._items.get(n,r).map(function(t){return function(t,e,i,n){var r=t.items,s=t.outlines,o=s.start,a=s.end;if(0===o.legnth||0===a.length||!r.length||!r[0].el)return 2;var h=Math.min.apply(Math,o),u=Math.max.apply(Math,a);return n+e<h?1:u<i-e?-1:0}(t,h,e,o)}),l=c.length,f=t?0:c.lastIndexOf(0),p=t?c.indexOf(0)-1:c.length-1;t||-1===f||(f+=1),f<0||p<0||p<f||l<=p-f+1||(u({start:f=n+f,end:p=n+p}),t?this.setCursor("start",p+1):this.setCursor("end",f-1))}}},e.scroll=function(a){var t=this.getCursor("start"),e=this.getCursor("end"),i=this._items;if("number"==typeof a&&-1!==t&&-1!==e&&i.size()){var n=this._status.size,r=this.options,h=r.threshold,s=r.append,o=r.prepend,u=i.get(),c=a+n,l=Math.max.apply(Math,u[t].outlines.start),f=Math.min.apply(Math,u[e].outlines.end),p=u.map(function(t,e){var i=t.outlines,n=i.start,r=i.end;if(!n.length||!r.length)return!1;var s=Math.min.apply(Math,n),o=Math.max.apply(Math,r);return s-h<=c&&a<=o+h}),d=p.indexOf(!0),g=p.lastIndexOf(!0);~d&&d<t?o({cache:u.slice(d,Math.min(t,g+1))}):e<g?s({cache:u.slice(Math.max(d,e+1),g+1)}):f-h<=c?s({cache:u.slice(e+1,e+2)}):a<=l+h&&o({cache:u.slice(t-1,t)})}},e.setCursor=function(t,e){var i=this._status,n=this._items,r=n.size();if(!this.options.useRecycle){if(i.startCursor=0,n.getOutline(r-1,"end").length)return void(i.endCursor=r-1);if("end"!==t)return}"start"===t?i.startCursor=e:i.endCursor=Math.min(r-1,e),i.startCursor=Math.max(0,i.startCursor)},e.setStatus=function(t){this._status=v(this._status,t)},e.getStatus=function(t,e){var i=this._status,n=i.startCursor,r=i.endCursor,s=i.size,o=Math.max(this._items.indexOf(t),0),a=(this._items.indexOf(e)+1||this._items.size())-1,h=Math.max(n-o,~n?0:-1);return{startCursor:h,endCursor:Math.max(Math.min(r-o,a-o),h),size:s}},e.getEdgeOutline=function(t){var e=this._status,i=e.startCursor,n=e.endCursor;return-1===i||-1===n?[]:this._items.getOutline("start"===t?i:n,t)},e.getEdgeValue=function(t){var e=this.getEdgeOutline(t);return e.length?Math["start"===t?"min":"max"].apply(Math,e):0},e.getVisibleItems=function(){return this._items.pluck("items",this._status.startCursor,this._status.endCursor)},e.getCursor=function(t){return this._status["start"===t?"startCursor":"endCursor"]},e.getVisibleData=function(){return this._items.get(this._status.startCursor,this._status.endCursor)},e.remove=function(t){return this._items.remove(t,this._status.startCursor,this._status.endCursor)},e.clear=function(){this._status={startCursor:-1,endCursor:-1,size:-1}},t}(),rt=[];function st(t){ot.resizeAll()}var ot=function(){function i(){}return i.add=function(t,e){void 0===e&&(e="data-"),t.length||F(h,"resize",st),t.__PREFIX__=e,rt.push(t),i.resize(t)},i.remove=function(t,e){void 0===e&&(e=!1);var i=t.getAttribute(t.__PREFIX__+"fixed")||"width";e||(t.style["width"===i?"height":"width"]="");var n=rt.indexOf(t);~n&&(rt.splice(n,1),rt.length||j(h,"reisze",st))},i.resize=function(t,e){void 0===e&&(e="data-");var i="string"==typeof t.__PREFIX__?t.__PREFIX__:e,n=t.getAttribute(i+"width"),r=t.getAttribute(i+"height");if("height"===t.getAttribute(i+"fixed")){var s=B(t)||r;t.style.width=n/r*s+"px"}else{var o=q(t)||n;t.style.height=r/n*o+"px"}},i.resizeAll=function(){rt.forEach(function(t){return i.resize(t)})},i}();function at(t,e){return!!t.getAttribute(e+"width")}var ht=function(){function t(){}return t.waitImageLoaded=function(t,e){var i=e.prefix,n=void 0===i?"":i,r=e.length,s=e.type,o=e.complete,a=e.error,h=e.end,u=0,c=r;2!==s&&(u=c);var l=function(){0==--c&&h&&h()},f=function(){0===--u&&o&&o()},p=function(t,e){void 0===e&&(e=t.__ITEM_INDEX__),a&&a({target:t,itemIndex:e})},d=function t(e){var i=e.target||e.srcElement;j(i,"error",t),j(i,"load",t),1===s&&at(i,n)?ot.remove(i,"error"===e.type):f(),"error"===e.type&&p(i),delete i.__ITEM_INDEX__,l()};t.forEach(function(t,e){t.forEach(function(t){if(t.complete&&(!g||g&&t.naturalWidth))return t.naturalWidth||p(t,e),f(),void l();t.__ITEM_INDEX__=e,1===s&&at(t,n)&&(ot.add(t,n),f()),F(t,"load",d),F(t,"error",d),g&&t.setAttribute("src",t.getAttribute("src"))})})},t.checkImageLoaded=function(t){return"IMG"===t.tagName?t.complete?[]:[t]:T(t.querySelectorAll("img"))},t.check=function(t,e){var i=this,n=e.prefix,r=e.type,s=void 0===r?1:r,o=e.complete,a=e.error,h=e.end,u=t.map(function(t){return i.checkImageLoaded(t)}),c=u.reduce(function(t,e){return t+e.length},0);2!==s&&0!==c||setTimeout(function(){o&&o(),0===c&&h&&h()},0),0<c&&setTimeout(function(){i.waitImageLoaded(u,{prefix:n,length:c,type:s,complete:o,error:a,end:h})},0)},t}();function ut(t,e){return~t.indexOf(e)}var ct=function(){function t(t,e,i){void 0===i&&(i={}),v(this.options={attributePrefix:"data-",isEqualSize:!1,isConstantSize:!1,horizontal:!1},i),this._items=t,this._renderer=e,this._layout=null}var e=t.prototype;return e.setLayout=function(t){this._layout=t},e.setSize=function(t){this._layout.setSize(t)},e._complete=function(t,e,r,s,i){var o=this,n=this._items,a=r?"end":"start",h=n.indexOf(t[0]),u=n.getData(h+(r?-1:1)),c=u?u.outlines[a]:[0];this._renderer.updateSize(e),i({groups:t.map(function(t){var i=t.outlines[r?"start":"end"];if(!(s||!c.length||c.length!==i.length||!c.every(function(t,e){return t===i[e]})))return c=t.outlines[r?"end":"start"],et.renderItems(t.items),t;var e=t.items,n=o._layout[r?"append":"prepend"](e,c,!0);return v(t,n),et.renderItems(n.items),c=n.outlines[r?"end":"start"],n}),items:e,isAppend:r})},e._error=function(i,n,r,t,s,e){var o=t[s],a=o.el,h=this.options.attributePrefix,u=function(){if(!ut(i,a)){i.push(a);var t=n.indexOf(s);-1!==t&&n.splice(t,1)}};e({target:r,element:a,items:t,item:o,itemIndex:s,replace:function(t){if(!ut(i,a)){if(t)if(R(t)||"object"==typeof t){var e=r.parentNode;e.insertBefore(k(t),r),e.removeChild(r),o.content=a.outerHTML}else r.src=t,r.getAttribute(h+"width")&&(ot.remove(r),r.removeAttribute(h+"width"),r.removeAttribute(h+"height"));o.content=a.outerHTML,ut(n,s)||n.push(s)}},replaceItem:function(t){ut(i,a)||(a.innerHTML=t,o.content=a.outerHTML,ut(n,s)||n.push(s))},remove:function(){r!==a?ut(i,a)||(r.parentNode.removeChild(r),o.content=a.outerHTML,ut(n,s)||n.push(s)):u()},removeItem:u})},e._end=function(t,e,i,n){var r=this,s=this.options.attributePrefix,o=t.length,a=e.length;if(o||a){var h=e.map(function(t){return i[t]});a?ht.check(h.map(function(t){return t.el}),{prefix:s,complete:function(){r._renderer.updateSize(h),n({remove:t,layout:!0})}}):n({remove:t,layout:!0})}else n({remove:[]})},e._insert=function(t,e){var n=this,i=t.groups,r=t.items,s=void 0===r?$.pluck(i,"items"):r,o=t.isAppend,a=t.isUpdate,h=e.error,u=void 0===h?function(){}:h,c=e.complete,l=void 0===c?function(){}:c,f=e.end,p=void 0===f?function(){}:f;if(i.length){var d=o?i:i.reverse(),g=[],_=[],v=s.map(function(t){return t.el}),m=this.options.isEqualSize&&this._renderer._size.item?2:1,y=this.options.attributePrefix;ht.check(v,{prefix:y,type:m,complete:function(){n._items&&n._complete(d,s,o,a,l)},error:function(t){var e=t.target,i=t.itemIndex;n._items&&n._error(_,g,e,s,i,u)},end:function(){n._items&&n._end(_,g,s,p)}})}},e.append=function(t,e){var i=t.groups,n=t.items,r=t.isUpdate;void 0===e&&(e={}),this._insert({groups:i,items:n,isUpdate:r,isAppend:!0},e)},e.prepend=function(t,e){var i=t.groups,n=t.items,r=t.isUpdate;void 0===e&&(e={}),this._insert({groups:i,items:n,isUpdate:r,isAppend:!1},e)},e.layout=function(t,e,i){var n=this._renderer,r=n.options,s=r.isEqualSize,o=r.isConstantSize,a=e.filter(function(t){var e=t.items[0];return e.orgSize&&-1e4<e.rect.top});if(!a.length)return[];var h=a[0].outlines.start;return t&&(h=[h.length?Math.min.apply(Math,h):0],!o&&i.length&&(n.updateSize(i),s&&i[0].size&&$.pluck(a,"items").forEach(function(t){t.size=v({},i[0].size)}))),this._layout.layout(a,h),a},e.destroy=function(){this._items=null,this._renderer=null},t}();"function"!=typeof Object.create&&(Object.create=function(t,e){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object: "+t);if(null===t)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");function i(){}return i.prototype=t,new i});var lt=function(){var t=function(c){function t(t,e){var i;v((i=c.call(this)||this).options={itemSelector:"*",isOverflowScroll:!1,threshold:100,isEqualSize:!1,isConstantSize:!1,useRecycle:!0,horizontal:!1,transitionDuration:0,useFit:!0,attributePrefix:"data-"},e),L&&(i.options.useFit=!1),l&&(i.options.isOverflowScroll=!1),i._reset(),i._loadingBar={};var n=i.options,r=n.isOverflowScroll,s=n.isEqualSize,o=n.isConstantSize,a=n.horizontal,h=n.threshold,u=n.useRecycle;return i._items=new $,i._renderer=new et(t,{isEqualSize:s,isConstantSize:o,horizontal:a,container:r}),i._watcher=new it(i._renderer.view,{isOverflowScroll:r,horizontal:a,container:i._renderer.container,resize:function(){return i._onResize()},check:function(t){return i._onCheck(t)}}),i._infinite=new nt(i._items,{horizontal:a,useRecycle:u,threshold:h,append:function(t){return i._requestAppend(t)},prepend:function(t){return i._requestPrepend(t)},recycle:function(t){return i._recycle(t)}}),i}i(t,c);var e=t.prototype;return e.append=function(t,e){return this._manager&&this._insert({elements:t,isAppend:m,groupKey:e}),this},e.prepend=function(t,e){return this._manager&&this._insert({elements:t,isAppend:r,groupKey:e}),this},e.setLayout=function(t,e){void 0===e&&(e={});var i=this.options,n=i.isEqualSize,r=i.isConstantSize,s=i.attributePrefix,o=i.horizontal;return this._manager||(this._manager=new ct(this._items,this._renderer,{attributePrefix:s,isEqualSize:n,isConstantSize:r})),"function"==typeof t?this._manager.setLayout(new t(v(e,{horizontal:o}))):(t.options.horizontal=o,this._manager.setLayout(t)),this._renderer.resize(),this._setSize(this._renderer.getViewportSize()),this},e._setSize=function(t){this._infinite.setSize(this._renderer.getViewSize()),this._manager.setSize(t)},e.getItems=function(t){return void 0===t&&(t=!1),t?this._items.pluck("items"):this._infinite.getVisibleItems()},e._fitItems=function(t,e){void 0===e&&(e=0),0<t&&this._watcher.scrollBy(-t),this._items.fit(t,this.options.horizontal),et.renderItems(this.getItems()),this._setContainerSize(this._getEdgeValue("end")||e),t<0&&this._watcher.scrollBy(-t)},e._fit=function(t){void 0===t&&(t=this.options.useFit);var e=this._getEdgeValue("start"),i=2===this._getLoadingStatus()&&this._status.loadingSize||0,n=this.options,r=n.isConstantSize,s=n.isEqualSize;if(!n.useRecycle||!t||r||s)e<i&&this._fitItems(e-i,i),e=0;else{if(0===e&&!i)return 0;this._fitItems(e-i,i)}return this._isLoading()&&this._renderLoading(),e},e._getEdgeValue=function(t){return this._infinite.getEdgeValue(t)},e.layout=function(t){if(void 0===t&&(t=!0),!this._manager)return this;var e=this._renderer,i=this._items,n=this._infinite,r=e.resize(),s=this.getItems(),o=this.options,a=o.isEqualSize,h=o.isConstantSize,u=o.transitionDuration,c=t&&(a||h),l=i.size();if(t&&(this._watcher.resize(),r&&this._setSize(e.getViewportSize())),!l||!s.length){var f=T(e.container.children);return f.length?this._insert({elements:f,isAppend:!0,isChildren:!0}):this._requestAppend({}),this}var p=n.getCursor("start"),d=n.getCursor("end"),g=!c&&t&&r?i.get(p,d):i.get();return this._manager.layout(t,g,r?s:[]),c?this._fit():t&&r&&i.clearOutlines(p,d),et.renderItems(s,u),t&&this._watcher.setScrollPos(),this._onLayoutComplete({items:s,isAppend:m,fromCache:!0,isTrusted:!1,useRecycle:!1,isLayout:!0}),this},e.remove=function(t,e){if(void 0===e&&(e=!0),t){var i=this._infinite.remove(t);return i&&et.removeElement(t),e&&this.layout(!1),i}return null},e.getGroupKeys=function(t){return(t?this._items.get():this._infinite.getVisibleData()).map(function(t){return t.groupKey})},e.getStatus=function(t,e){return{_status:v({},this._status),_items:this._items.getStatus(t,e),_renderer:this._renderer.getStatus(),_watcher:this._watcher.getStatus(),_infinite:this._infinite.getStatus(t,e)}},e.setStatus=function(t,e){if(void 0===e&&(e=!0),!t)return this;var i=t._status,n=t._renderer,r=t._items,s=t._watcher,o=t._infinite;if(!(i&&n&&r&&s&&o))return this;var a=this._items,h=this._renderer,u=this._watcher,c=this._infinite;u.detachEvent(),v(this._status,i),this._status.processingStatus=0,a.setStatus(r),h.setStatus(n),c.setStatus(o);var l=this.getItems(),f=l.length;h.createAndInsert(l,!0);var p=h.isNeededResize();u.setStatus(s,e),u.attachEvent();var d=this.options,g=d.isConstantSize,_=d.isEqualSize;return f?p?(h.resize(),this._setSize(h.getViewportSize()),g?this.layout(!0):(this._items.clearOutlines(),this._postLayout({fromCache:!0,groups:_?a.get():c.getVisibleData(),items:l,newItems:l,isAppend:!0,isTrusted:!1}))):this.layout(!1):this._requestAppend({cache:l.slice(0,1)}),this},e.clear=function(){return this._items.clear(),this._renderer.clear(),this._infinite.clear(),this._reset(),this._appendLoadingBar(),this},e.setLoadingBar=function(t){void 0===t&&(t={});var e="object"==typeof t?t:{append:t,prepend:t};this._status.loadingSize=0,this._status.loadingStyle={};var i=this._loadingBar;for(var n in e)i[n]=k(e[n]),i[n].className+=" "+f;return this._appendLoadingBar(),this},e._appendLoadingBar=function(){var t=this._loadingBar,e=this._renderer.container;for(var i in t)e.appendChild(t[i])},e.isProcessing=function(){return this._isProcessing()||this._isLoading()},e._isProcessing=function(){return 0<(4&this._status.processingStatus)},e._isLoading=function(){return 0<this._getLoadingStatus()},e._getLoadingStatus=function(){return 3&this._status.processingStatus},e._process=function(t,e){void 0===e&&(e=!0),e?this._status.processingStatus|=t:this._status.processingStatus-=this._status.processingStatus&t},e._insert=function(t){var e=t.elements,i=t.isAppend,n=t.isChildren,r=t.groupKey,s=void 0===r?(new Date).getTime()+Math.floor(1e3*Math.random()):r;if(!this._isProcessing()&&0!==e.length){var o=$.from(e,this.options.itemSelector,{isAppend:i,groupKey:s,outlines:{start:[],end:[]}});if(o.length){var a={groupKey:s,items:o,outlines:{start:[],end:[]}},h=i?"append":"prepend";if(this._items[h](a),!i){var u=this._infinite,c=u.getCursor("start"),l=u.getCursor("end");u.setCursor("start",c+1),u.setCursor("end",l+1)}this._postLayout({fromCache:!1,groups:[a],items:o,newItems:o,isAppend:i,isChildren:n,isTrusted:!1})}}},e._recycle=function(t){var e=t.start,i=t.end;this.options.useRecycle&&et.removeItems(this._items.pluck("items",e,i))},e.getLoadingBar=function(t){return void 0===t&&(t=2!==this._getLoadingStatus()),this._loadingBar[t?"append":"prepend"]},e.startLoading=function(t,e){if(void 0===e&&(e={display:"block"}),this._isLoading())return this;var i=t?"append":"prepend";return this._process(t?1:2),this._loadingBar[i]&&(this._renderLoading(e),this._status.loadingStyle=e,t?this._setContainerSize(this._getEdgeValue("end")+this._status.loadingSize):this._fit()),this},e._renderLoading=function(t){if(void 0===t&&(t=this._status.loadingStyle),this._isLoading()){var e=1===this._getLoadingStatus(),i=this._loadingBar[e?"append":"prepend"];if(i){var n=v({position:"absolute"},t);for(var r in n)i.style[r]=n[r];this._status.loadingSize=this.options.horizontal?N(i):K(i);var s=this.options.horizontal?"left":"top";if(!(s in n)){var o=e?this._getEdgeValue("end"):this._getEdgeValue("start")-this._status.loadingSize;i.style[s]=o+"px"}}}},e.endLoading=function(t){if(void 0===t&&(t={display:"none"}),!this._isLoading())return this;var e=1===this._getLoadingStatus(),i=e?"append":"prepend",n=this._loadingBar[i],r=this._status,s=r.loadingSize;if(this._process(3,!1),r.loadingSize=0,r.loadingStyle={},n){var o,a=v(((o={})[this.options.horizontal?"left":"top"]=-s+"px",o),t);for(var h in a)n.style[h]=a[h];e?this._setContainerSize(this._getEdgeValue("end")):this._fitItems(s)}return this.options.useRecycle&&!this.isProcessing()&&this._infinite.recycle(this._watcher.getScrollPos(),e),this},e._setContainerSize=function(t){this._renderer.setContainerSize(Math.max(this._items.getMaxEdgeValue(),t))},e.getItem=function(t,e){if(void 0===t&&(t=0),null!=e||"object"!=typeof t){var i=this._items.getData(t);return i&&i.items[e||0]}if(t)for(var n=this.getItems(),r=n.length,s=0;s<r;++s)if(n[s].el===t)return n[s]},e._updateItem=function(t){return!(!t||!t.el)&&(t.content=t.el.outerHTML,!this.options.isEqualSize&&((e=t).orgSize=0,e.size=0),this._renderer.updateSize([t]),!0);var e},e.updateItem=function(t,e){var i=this.getItem(t,e);return this._updateItem(i)&&this.layout(!1),this},e.updateItems=function(){var e=this;return this.getItems().forEach(function(t){e._updateItem(t)}),this.layout(!1),this},e.moveTo=function(t,e){if(void 0===e&&(e=0),this.isProcessing())return this;var i=this._items.getData(t);if(!i)return this;var n=this._infinite,r=i.outlines,s=i.items,o=s[e],a=r.start&&0===r.start.length,h=n.getCursor("start"),u=n.getCursor("end"),c=h<=t&&t<=u,l=this.options,f=l.useRecycle,p=l.horizontal;if(c||!f||!a){var d=o?o.rect[p?"left":"top"]:Math.max.apply(Math,r.start),g=Math.min.apply(Math,r.start);g<0&&(this._fitItems(g,0),d-=g);var _=h<t;return c||_?this._scrollTo(d):this._postLayout({fromCache:!0,groups:[i],items:s,newItems:[],isAppend:_,isTrusted:!1,moveCache:!0,moveItem:e}),this}var v=u<t||t<h-1;return this._postCache({isAppend:v,cache:[i],isTrusted:!1,moveItem:e}),this},e._setScrollPos=function(t){this._watcher.setScrollPos(this._watcher.getContainerOffset()+t)},e._scrollTo=function(t){this._watcher.scrollTo(this._watcher.getContainerOffset()+t)},e._onImageError=function(t){this.trigger("imageError",v(t,{element:t.item.el}))},e._postCache=function(t){var e=t.cache,i=t.isAppend,n=t.isTrusted,r=void 0===n||n,s=t.moveItem,o=void 0===s?-1:s,a=this.options.isConstantSize,h=$.pluck(e,"items"),u=!0,c=h.filter(function(t){return t.orgSize?!a&&t.rect.top<-1e4:!(u=!1)});this._postLayout({fromCache:u,groups:e,items:h,newItems:c,isAppend:i,isTrusted:r,moveItem:o})},e._postLayout=function(t){var a=this,h=t.fromCache,u=t.groups,e=t.items,c=void 0===e?$.pluck(u,"items"):e,i=t.newItems,l=t.isAppend,n=t.isChildren,f=t.isTrusted,p=t.moveCache,r=t.moveItem,d=void 0===r?-2:r;this._process(4);var s=l?"append":"prepend",g=this._items,_=this.options.horizontal;return n||(et.createElements(c),this._renderer[s](c)),this._manager[s]({groups:u,items:i,isAppend:l},{complete:function(){var t=a._infinite,e=Math.max(t.getCursor("start"),0),i=Math.max(t.getCursor("end"),0),n=g.indexOf(u[0].groupKey),r=g.indexOf(u[u.length-1].groupKey),s=!0;if((i+1<n||r<e-1)&&(s=!1),s&&(r=l?(n=e,Math.max(i,r)):(n=Math.max(Math.min(e,n),0),i)),!s&&a._recycle({start:e,end:i}),t.setCursor("start",n),t.setCursor("end",r),-1<d){var o=c[d].rect[_?"left":"top"];s||p||g.clearOutlines(n,r),a._scrollTo(o),a._setScrollPos(o)}a._onLayoutComplete({groups:u,items:c,isAppend:l,fromCache:h,isTrusted:f,useRecycle:!1})},error:function(t){return a._onImageError(t)},end:function(t){var e=t.remove,i=t.layout;if(e.forEach(function(t){return a.remove(t,!1)}),i)a.layout(!1);else if(!a.isProcessing()&&a.options.useRecycle){var n=a._watcher.getScrollPos();a._infinite.recycle(n,l)}}}),this},e._requestAppend=function(t){var e=this,i=t.cache;this._isProcessing()||(i&&i.length?this._postCache({cache:i,isAppend:m}):this.trigger("append",{isTrusted:!0,groupKey:this.getGroupKeys().pop()||"",startLoading:function(t){e.startLoading(!0,t)},endLoading:function(t){e.endLoading(t)}}))},e._requestPrepend=function(t){var e=this,i=t.cache;this._fit(this.options.useFit||!i.length),this._isProcessing()||(i&&i.length?this._postCache({cache:i,isAppend:r}):this.trigger("prepend",{isTrusted:!0,groupKey:this.getGroupKeys().shift(),startLoading:function(t){e.startLoading(!1,t)},endLoading:function(t){e.endLoading(t)}}))},e._onResize=function(){this.layout(!0)},e._onCheck=function(t){var e=t.isForward,i=t.scrollPos,n=t.horizontal,r=t.orgScrollPos;this.trigger("change",{isForward:e,horizontal:n,scrollPos:i,orgScrollPos:r}),this._infinite.scroll(i)},e._onLayoutComplete=function(t){var e=this,i=t.items,n=t.isAppend,r=t.isTrusted,s=void 0!==r&&r,o=t.useRecycle,a=void 0===o?this.options.useRecycle:o,h=t.fromCache,u=void 0!==h&&h,c=t.isLayout,l=void 0!==c&&c,f=this._renderer.getViewSize();n?this._isLoading()&&this._renderLoading():this._fit();var p=this._watcher,d=p.getScrollPos();l||!a||this._isLoading()||this._infinite.recycle(d,n);var g=this._getEdgeValue("end");n&&(this._setContainerSize(g+this._status.loadingSize||0),0<d&&!_&&this._scrollTo(d)),!l&&this._process(4,!1),this.trigger("layoutComplete",{target:i.concat(),isAppend:n,isTrusted:s,fromCache:u,isLayout:l,isScroll:f<p.getContainerOffset()+g,scrollPos:d,orgScrollPos:p.getOrgScrollPos(),size:g,endLoading:function(t){e.endLoading(t)}}),this._infinite.scroll(d,n)},e._reset=function(){this._status={processingStatus:0,loadingSize:0}},e.destroy=function(){this._infinite.clear(),this._watcher.destroy(),this._manager.destroy(),this._reset(),this._items.clear(),this._renderer.destroy()},t}(e);return t.VERSION="3.5.0",t}(),ft=w,pt=C,dt=I,gt=E,_t=function(){function t(t){void 0===t&&(t={}),this.options=U({margin:0,horizontal:!1,align:ft,itemSize:0},t),this._size=0,this._columnSize=0,this._columnLength=0,this._style=G(this.options.horizontal)}var e=t.prototype;return e.checkColumn=function(t){var e=this.options,i=e.itemSize,n=e.margin,r=e.horizontal?"height":"width",s=parseInt(i||t&&t.size[r],10)||0;(this._columnSize=s)?this._columnLength=Math.max(parseInt((this._size+n)/(s+n),10),1):this._columnLength=1},e._layout=function(t,e,i){for(var n=t.length,r=this.options.margin,s=this.options.align,o=this._style,a=o.size1,h=o.size2,u=o.pos1,c=o.pos2,l=this._columnSize,f=this._columnLength,p=this._size,d=p-(l+r)*f+r,g=i?"min":"max",_=e.slice(),v=e.slice(),m=0;m<n;++m){var y,z=Math[g].apply(Math,v)||0,S=v.indexOf(z),w=t[i?m:n-1-m],C=w.size[a],I=w.size[h],E=i?z:z-r-C,M=E+C+r;-1===S&&(S=0);var x=(l+r)*S;s===pt?x+=d/2:s===dt?x+=d+l-I:s===gt&&(f<=1?x+=d/2:x=(p-l)/(f-1)*S),w.rect=((y={})[u]=E,y[c]=x,y),v[w.column=S]=i?M:E}return i||t.sort(function(t,e){var i=t.rect[u],n=t.rect[c],r=e.rect[u],s=e.rect[c];return i-r?i-r:n-s}),{start:i?_:v,end:i?v:_}},e._insert=function(t,e,i,n){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=n?t:Y(t),s=e;return this._columnLength||this.checkColumn(t[0]),e.length!==this._columnLength&&(s=Q(new Array(this._columnLength),0===e.length?0:Math[i===m?"min":"max"].apply(Math,e)||0)),{items:r,outlines:this._layout(r,s,i)}},e.append=function(t,e,i){return this._insert(t,e,m,i)},e.prepend=function(t,e,i){return this._insert(t,e,r,i)},e.layout=function(t,e){var n=this;void 0===t&&(t=[]),void 0===e&&(e=[]);var r,i=t.length&&t[0].items.length&&t[0].items[0]||0;if(this.checkColumn(i),e.length!==this._columnLength){var s=0===e.length?0:Math.min.apply(Math,e);r=Q(new Array(this._columnLength),s)}else r=e.slice();return t.forEach(function(t){var e=t.items,i=n._layout(e,r,m);t.outlines=i,r=i.end}),this},e.setSize=function(t){return this._size=t,this},t}();function vt(t,e,i,n,r,s){for(var o={left:n,top:i,type:e,width:1,height:1},a=n;a<r&&t[i][a]===e;++a)o.width=a-n+1;for(var h=i;h<s&&t[h][n]===e;++h)o.height=h-i+1;return function(t,e,i,n,r,s){for(var o=n;o<n+s;++o)for(var a=i;a<i+r;++a)e===t[o][a]&&(t[o][a]=0)}(t,e,n,i,o.width,o.height),o}var mt=function(){function t(t){void 0===t&&(t={}),this.options=U({margin:0,horizontal:!1,itemSize:0,frame:[],frameFill:!0},t);var e=this.options.frame.map(function(t){return t.slice()});this._itemSize=this.options.itemSize||0,this._shapes=function(t){for(var e=t.length,i=e?t[0].length:0,n=[],r=0;r<e;++r)for(var s=0;s<i;++s){var o=t[r][s];o&&n.push(vt(t,o,r,s,i,e))}return n.sort(function(t,e){return t.type<e.type?-1:1}),{shapes:n,width:i,height:e}}(e),this._size=0,this._style=G(this.options.horizontal)}var e=t.prototype;return e._getItemSize=function(){return this._checkItemSize(),this._itemSize},e._checkItemSize=function(){if(this.options.itemSize)this._itemSize=this.options.itemSize;else{var t=this._style.size2,e=this.options.margin;this._itemSize=(this._size+e)/this._shapes[t]-e}},e._layout=function(t,e,i){void 0===e&&(e=[]);var n=t.length,r=this._style,s=this.options,o=s.margin,a=s.frameFill,h=r.size1,u=r.size2,c=r.pos1,l=r.pos2,f=this._getItemSize(),p="object"==typeof f,d=p?f[u]:f,g=p?f[h]:f,_=this._shapes[u],v=this._shapes.shapes,m=v.length,y=Q(new Array(_),W),z=Q(new Array(_),W),S=0,w=0;if(!m)return{start:e,end:e};for(var C=0;C<n;C+=m){for(var I=0;I<m&&C+I<n;++I){for(var E,M=t[C+I],x=v[I],L=x[c],b=x[l],O=x[h],P=x[u],A=w-S+L*(g+o),T=b*(d+o),R=O*(g+o)-o,k=P*(d+o)-o,F=b;F<b+P&&F<_;++F)y[F]===W&&(y[F]=A),y[F]=Math.min(y[F],A),z[F]=Math.max(z[F],A+R+o);M.rect=((E={})[c]=A,E[l]=T,E[h]=R,E[u]=k,E)}if(w=Math.max.apply(Math,z),0===C)if(a){S=w;for(var j=0;j<_;++j)y[j]!==W&&(S=Math.min(y[j]+w-z[j],S))}else S=0}for(var H=0;H<_;++H)y[H]===W&&(y[H]=Math.max.apply(Math,y),z[H]=y[H]);var V=i?y:z,q=0===e.length?0:Math[i?"max":"min"].apply(Math,e),B=i?0:w;if(a&&e.length===_){B=-W;for(var N=0;N<_;++N)y[N]!==z[N]&&(B=Math.min(V[N]+q-e[N],B))}for(var K=0;K<_;++K)y[K]+=q-B,z[K]+=q-B;return t.forEach(function(t){t.rect[c]+=q-B}),{start:y.map(function(t){return parseInt(t,10)}),end:z.map(function(t){return parseInt(t,10)})}},e._insert=function(t,e,i,n){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=n?t:Y(t);return{items:r,outlines:this._layout(r,e,i)}},e.layout=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);for(var i=t.length,n=e,r=0;r<i;++r){var s=t[r];n=this._layout(s.items,n,m),n=(s.outlines=n).end}return this},e.setSize=function(t){return this._size=t,this},e.append=function(t,e,i){return this._insert(t,e,m,i)},e.prepend=function(t,e,i){return this._insert(t,e,r,i)},t}();function yt(t){if(t.column)return t.column;var e=0;if(t.el){var i=t.el.dataset;e=i?i.column||1:t.el.getAttribute("column")||1}else e=1;return t.column=e}var zt=function(O){function t(){return O.apply(this,arguments)||this}i(t,O);var e=t.prototype;return e._checkItemSize=function(){var t=this.options.column;if(t){var e=this.options.margin;this._itemSize=(this._size+e)/t-e}else O.prototype._checkItemSize.call(this)},e._layout=function(t,e,i){var n;void 0===e&&(e=[]);for(var r,s,o,a,h=this._getItemSize(),u=this.options.margin,c=this.options.column||parseInt((this._size+u)/(h+u),10)||1,l=t.length,f=(r=e,s=h,o=c,a=Math[i?"min":"max"].apply(Math,r)||0,r.length!==o?Q(new Array(o),0):r.map(function(t){return parseInt((t-a)/s,10)})),p=i?"min":"max",d=[],g=i?1:-1,_=this._style,v=_.pos1,m=_.pos2,y=0;y<l;++y){var z,S=Math[p].apply(Math,f),w=f[i?"indexOf":"lastIndexOf"](S),C=t[y],I=C.columnWidth,E=I&&I[0]===c&&I[1]||yt(C),M=1;if(1<E){for(var x=1;x<E&&(i&&w+x<c||!i&&0<=w-x)&&(i&&f[w+g*x]<=S||!i&&f[w+g*x]>=S);++x)++M;i||(w-=M-1)}C.columnWidth=[c,M],d.push(((z={width:M,height:M})[v]=S-(i?0:M),z[m]=w,z.index=y,z));for(var L=0;L<M;++L)f[w+L]=S+g*M}this._shapes=((n={shapes:d})[_.size2]=c,n);var b=O.prototype._layout.call(this,t,e,i);return i||(d.sort(function(t,e){var i=t[v],n=t[m],r=e[v],s=e[m];return i-r?i-r:n-s}),t.sort(function(t,e){var i=t.rect[v],n=t.rect[m],r=e.rect[v],s=e.rect[m];return i-r?i-r:n-s})),b},t}(mt),St=function(){function t(t){v(this,{originWidth:0,originHeight:0,width:0,height:0,left:0,top:0,items:[]},t)}var e=t.prototype;return e.scaleTo=function(t,e){var i=this.width?t/this.width:0,n=this.height?e/this.height:0;this.items.forEach(function(t){0!==i&&(t.left*=i,t.width*=i),0!==n&&(t.top*=n,t.height*=n)}),this.width=t,this.height=e},e.push=function(t){this.items.push(t)},e.getOriginSize=function(){return this.originWidth*this.originHeight},e.getSize=function(){return this.width*this.height},e.getOriginRatio=function(){return 0===this.originHeight?0:this.originWidth/this.originHeight},e.getRatio=function(){return 0===this.height?0:this.width/this.height},t}();function wt(t,e){var i=t/e;return i<1&&(i=1/i),i-1}var Ct=function(){function t(t){void 0===t&&(t={}),this.options=U({margin:0,horizontal:!1,aspectRatio:1,sizeWeight:1,ratioWeight:1},t),this._size=0,this._style=G(this.options.horizontal)}var e=t.prototype;return e._findBestFitArea=function(t,g){if(0===t.getRatio())return t.originWidth=g.width,t.originHeight=g.height,t.width=g.width,void(t.height=g.height);var e,i,n,r,s,_=null,v=1e7,m=!1,y={width:0,height:0},z={width:0,height:0},o=this.options,S=o.sizeWeight,w=o.ratioWeight;t.items.forEach(function(t){for(var e,i=wt(t.getOriginSize(),t.getSize())*S,n=wt(t.getOriginRatio(),t.getRatio())*w,r=t.width,s=t.height,o=0;o<2;++o){var a=void 0,h=void 0,u=void 0,c=void 0;0===o?(u=a=r,c=s-(h=s*(g.height/(t.originHeight+g.height)))):(c=h=s,u=r-(a=r*(g.width/(t.originWidth+g.width))));var l=a*h,f=a/h,p=u*c,d=c/c;e=wt(g.getSize(),l)*S,e+=wt(g.getRatio(),f)*w,e+=wt(t.getOriginSize(),p)*S-i,(e+=wt(t.getOriginRatio(),d)*w-n)===Math.min(e,v)&&(v=e,_=t,m=0===o,y.width=a,y.height=h,z.width=u,z.height=c)}}),i=_,n=y,r=z,s=m,(e=g).height=n.height,e.width=n.width,i.height=r.height,i.width=r.width,s?(e.top=i.top+i.height,e.left=i.left):(e.left=i.left+i.width,e.top=i.top)},e._layout=function(t,e,i){var s=this;void 0===e&&(e=[]);var n,r=this._style,o=this.options,a=o.horizontal,h=o.aspectRatio,u=o.margin,c=r.pos1,l=this._size*(a?h:1),f=this._size/(a?1:h),p=a?l:f,d=(n=e)&&n.length?n:[0],g=i?Math.max.apply(Math,d):Math.min.apply(Math,d)-p-u,_=g+p+u,v=new St({});return t.forEach(function(t){var e=t.orgSize,i=e.width,n=e.height,r=new St({width:i,height:n,originWidth:i,originHeight:n});s._findBestFitArea(v,r),v.push(r),v.scaleTo(l+u,f+u)}),t.forEach(function(t,e){var i=v.items[e],n=i.width,r=i.height,s=i.top,o=i.left;t.rect={top:s,left:o,width:n-u,height:r-u},t.rect[c]+=g}),{start:[g],end:[_]}},e._insert=function(t,e,i,n){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=n?t:Y(t);return{items:r,outlines:this._layout(r,e,i)}},e.append=function(t,e,i){return this._insert(t,e,m,i)},e.prepend=function(t,e,i){return this._insert(t,e,r,i)},e.layout=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);for(var i=t.length,n=e,r=0;r<i;++r){var s=t[r];n=this._layout(s.items,n,m),n=(s.outlines=n).end}return this},e.setSize=function(t){return this._size=t,this},t}(),It={single_source_shortest_paths:function(t,e,i){var n={},r={};r[e]=0;var s,o,a,h,u,c,l=new Et(function(t){return t.cost});for(l.push({value:e,cost:0});l.size();)for(var f in o=(s=l.pop()).value,a=s.cost,h=t(o)||{})u=a+h[f],c=r[f],(void 0===r[f]||u<c)&&(r[f]=u,l.push({value:f,cost:u}),n[f]=o);if(void 0!==r[i])return n;var p=["Could not find a path from ",e," to ",i,"."].join("");throw new Error(p)},extract_shortest_path_from_predecessor_list:function(t,e){for(var i=[],n=e;n;)i.push(n),t[n],n=t[n];return i.reverse(),i},find_path:function(t,e,i){var n=It.single_source_shortest_paths(t,e,i);return It.extract_shortest_path_from_predecessor_list(n,i)}},Et=function(){function t(t){this.content=[],this.scoreFunction=t}var e=t.prototype;return e.push=function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},e.pop=function(){var t=this.content[0],e=this.content.pop();return 0<this.content.length&&(this.content[0]=e,this.sinkDown(0)),t},e.size=function(){return this.content.length},e.bubbleUp=function(t){for(var e=this.content[t];0<t;){var i=Math.floor((t+1)/2)-1,n=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[i]=e,this.content[t]=n,t=i}},e.sinkDown=function(t){for(var e=this.content.length,i=this.content[t],n=this.scoreFunction(i);;){var r=2*(t+1),s=r-1,o=null;if(s<e){var a=this.content[s],h=this.scoreFunction(a);h<n&&(o=s)}if(r<e){var u=this.content[r];this.scoreFunction(u)<(null==o?n:h)&&(o=r)}if(null===o)break;this.content[t]=this.content[o],this.content[o]=i,t=o}},t}(),Mt={GridLayout:_t,FrameLayout:mt,SquareLayout:zt,PackingLayout:Ct,JustifiedLayout:function(){function t(t){void 0===t&&(t={}),this.options=U({margin:0,horizontal:!1,minSize:0,maxSize:0,column:[1,8]},t),this._style=G(this.options.horizontal),this._size=0}var e=t.prototype;return e._layout=function(o,t,e){var a=this,i=this._style,h=i.size1,u=i.size2,c=o.length,l=this.options.column;"object"!=typeof l&&(l=[l,l]);var n=It.find_path(function(t){for(var e={},i=+t.replace(/[^0-9]/g,""),n=c+1,r=Math.min(i+l[0],n-1);r<n&&!(r-i>l[1]);++r){var s=a._getCost(o,i,r,h,u);null!==s&&(s<0&&r===n-1&&(s=0),e[""+r]=Math.pow(s,2))}return e},"0",""+c);return this._setStyle(o,n,t,e)},e._getSize=function(t,i,n){var e=this.options.margin,r=t.reduce(function(t,e){return t+e.orgSize[n]/e.orgSize[i]},0);return(this._size-e*(t.length-1))/r},e._getCost=function(t,e,i,n,r){var s=this._getSize(t.slice(e,i),n,r),o=this.options.minSize||0,a=this.options.maxSize||1/0;return isFinite(a)?s<o?Math.pow(s-o,2)+Math.pow(a,2):a<s?Math.pow(s-a,2)+Math.pow(a,2):Math.min(s-a,o-s):s<o?Math.max(Math.pow(o,2),Math.pow(s,2)):s-o},e._setStyle=function(t,e,i,n){void 0===i&&(i=[]);for(var r=this._style,s=r.pos1,o=r.size1,a=r.pos2,h=r.size2,u=e.length,c=this.options.margin,l=i[0]||0,f=l,p=0,d=0;d<u-1;++d){for(var g=parseInt(e[d],10),_=parseInt(e[d+1],10),v=t.slice(g,_),m=v.length,y=this._getSize(v,o,h),z=f,S=0;S<m;++S){var w,C=v[S],I=C.orgSize[h]/C.orgSize[o]*y,E=0===S?0:v[S-1].rect,M=E?E[a]+E[h]+c:0;C.rect=((w={})[s]=z,w[a]=M,w[o]=y,w[h]=I,w)}f=l+(p+=c+y)}var x=t.length;if(n)return{start:[l],end:[f]};for(var L=0;L<x;++L){t[L].rect[s]-=p}return{start:[l-p],end:[l]}},e._insert=function(t,e,i,n){void 0===t&&(t=[]),void 0===e&&(e=[]);var r=n?t:Y(t);return{items:r,outlines:this._layout(r,e,i)}},e.setSize=function(t){return this._size=t,this},e.append=function(t,e,i){return this._insert(t,e,m,i)},e.prepend=function(t,e,i){return this._insert(t,e,r,i)},e.layout=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]);for(var i=t.length,n=e,r=0;r<i;++r){var s=t[r];n=this._layout(s.items,n,m),n=(s.outlines=n).end}return this},t}(),Infinite:nt,ImageLoaded:ht,AutoSizer:ot,DOMRenderer:et,Watcher:it,ItemManager:$,LayoutManager:ct,default:lt};for(var xt in Mt)lt[xt]=Mt[xt];return lt});
//# sourceMappingURL=infinitegrid.pkgd.min.js.map
